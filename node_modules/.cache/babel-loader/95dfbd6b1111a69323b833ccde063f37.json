{"ast":null,"code":"import _regeneratorRuntime from \"/home/vladimir/workspace/bestonlinemenus.loc/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\n\n(function () {\n  var enterModule = (typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal : require('react-hot-loader')).enterModule;\n  enterModule && enterModule(module);\n})();\n\nvar _marked =\n/*#__PURE__*/\n_regeneratorRuntime.mark(createDishFromModalSaga),\n    _marked2 =\n/*#__PURE__*/\n_regeneratorRuntime.mark(updateDishFromModalSaga),\n    _marked3 =\n/*#__PURE__*/\n_regeneratorRuntime.mark(patchDishExtrasFromModalSaga),\n    _marked4 =\n/*#__PURE__*/\n_regeneratorRuntime.mark(patchDishSizesFromModalSaga),\n    _marked5 =\n/*#__PURE__*/\n_regeneratorRuntime.mark(resetDishModalFormsSaga),\n    _marked6 =\n/*#__PURE__*/\n_regeneratorRuntime.mark(destroyDishModalFormsSaga),\n    _marked7 =\n/*#__PURE__*/\n_regeneratorRuntime.mark(dishModalSaga);\n\nimport { takeLatest, all, put, select, call } from 'redux-saga/effects';\nimport { reset, destroy } from 'redux-form';\nimport { DISH_MODAL__CREATE, DISH_MODAL__UPDATE_INFO, DISH_MODAL__RESET_FORMS, DISH_MODAL__PATCH_EXTRAS, DISH_MODAL__PATCH_SIZES, DISH_MODAL__FULLY_CLEAR } from './dish-modal.types';\nimport { SIZES_FORM, EXTRAS_FORM, DISH_INFO_FORM } from '../../../components/forms/constants/form.names';\nimport { updateDishSaga, patchDishExtrasSaga, patchDishSizesSaga, createDishSaga, dishListFiltersSelector } from '../../dishes';\nimport { dishInfoFormValuesSelector, extrasFormValuesSelector, sizesFormValuesSelector } from '../../../components/forms/selectors';\nimport { setDishModal } from './dish-modal.actions';\nimport { showToast } from '../../../scenes/Toasts/modules';\nimport { managedDishIdSelector } from './dish-modal.selectors';\n\nfunction createDishFromModalSaga() {\n  var body, filters, dish;\n  return _regeneratorRuntime.wrap(function createDishFromModalSaga$(_context) {\n    while (1) {\n      switch (_context.prev = _context.next) {\n        case 0:\n          _context.prev = 0;\n          _context.next = 3;\n          return select(dishInfoFormValuesSelector);\n\n        case 3:\n          body = _context.sent;\n          _context.next = 6;\n          return select(dishListFiltersSelector);\n\n        case 6:\n          filters = _context.sent;\n          body.category_id = filters.category_id;\n          _context.next = 10;\n          return call(createDishSaga, {\n            payload: body\n          });\n\n        case 10:\n          dish = _context.sent;\n          _context.next = 13;\n          return put(setDishModal({\n            dishId: dish.id\n          }));\n\n        case 13:\n          _context.next = 15;\n          return put(showToast({\n            text: 'The dish created successful',\n            type: 'success'\n          }));\n\n        case 15:\n          _context.next = 17;\n          return put(reset(DISH_INFO_FORM));\n\n        case 17:\n          _context.next = 24;\n          break;\n\n        case 19:\n          _context.prev = 19;\n          _context.t0 = _context[\"catch\"](0);\n          console.error(_context.t0);\n          _context.next = 24;\n          return put(showToast({\n            text: 'Some error occured while dish creating',\n            type: 'error'\n          }));\n\n        case 24:\n        case \"end\":\n          return _context.stop();\n      }\n    }\n  }, _marked, this, [[0, 19]]);\n}\n\nfunction updateDishFromModalSaga() {\n  var payload, id, filters;\n  return _regeneratorRuntime.wrap(function updateDishFromModalSaga$(_context2) {\n    while (1) {\n      switch (_context2.prev = _context2.next) {\n        case 0:\n          _context2.prev = 0;\n          _context2.next = 3;\n          return select(dishInfoFormValuesSelector);\n\n        case 3:\n          payload = _context2.sent;\n          _context2.next = 6;\n          return select(managedDishIdSelector);\n\n        case 6:\n          id = _context2.sent;\n          _context2.next = 9;\n          return select(dishListFiltersSelector);\n\n        case 9:\n          filters = _context2.sent;\n          payload.category_id = filters.category_id;\n          payload.id = id;\n          _context2.next = 14;\n          return call(updateDishSaga, {\n            payload: payload\n          });\n\n        case 14:\n          _context2.next = 16;\n          return put(showToast({\n            text: 'The dish updated successful',\n            type: 'success'\n          }));\n\n        case 16:\n          _context2.next = 23;\n          break;\n\n        case 18:\n          _context2.prev = 18;\n          _context2.t0 = _context2[\"catch\"](0);\n          console.error(_context2.t0);\n          _context2.next = 23;\n          return put(showToast({\n            text: 'Some error occured while dish updating',\n            type: 'error'\n          }));\n\n        case 23:\n        case \"end\":\n          return _context2.stop();\n      }\n    }\n  }, _marked2, this, [[0, 18]]);\n}\n\nfunction patchDishExtrasFromModalSaga() {\n  var dishId, extrasPayload, payload;\n  return _regeneratorRuntime.wrap(function patchDishExtrasFromModalSaga$(_context3) {\n    while (1) {\n      switch (_context3.prev = _context3.next) {\n        case 0:\n          _context3.prev = 0;\n          _context3.next = 3;\n          return select(managedDishIdSelector);\n\n        case 3:\n          dishId = _context3.sent;\n          _context3.next = 6;\n          return select(extrasFormValuesSelector);\n\n        case 6:\n          extrasPayload = _context3.sent;\n          payload = {\n            dishId: dishId,\n            extrasPayload: extrasPayload\n          };\n          _context3.next = 10;\n          return call(patchDishExtrasSaga, {\n            payload: payload\n          });\n\n        case 10:\n          _context3.next = 12;\n          return put(showToast({\n            text: 'The dish extras saved successful',\n            type: 'success'\n          }));\n\n        case 12:\n          _context3.next = 14;\n          return put(reset(EXTRAS_FORM));\n\n        case 14:\n          _context3.next = 21;\n          break;\n\n        case 16:\n          _context3.prev = 16;\n          _context3.t0 = _context3[\"catch\"](0);\n          console.error(_context3.t0);\n          _context3.next = 21;\n          return put(showToast({\n            text: 'Some error occured while saving dish extras',\n            type: 'error'\n          }));\n\n        case 21:\n        case \"end\":\n          return _context3.stop();\n      }\n    }\n  }, _marked3, this, [[0, 16]]);\n}\n\nfunction patchDishSizesFromModalSaga() {\n  var dishId, items, filters, sizesPayload, payload;\n  return _regeneratorRuntime.wrap(function patchDishSizesFromModalSaga$(_context4) {\n    while (1) {\n      switch (_context4.prev = _context4.next) {\n        case 0:\n          _context4.prev = 0;\n          _context4.next = 3;\n          return select(managedDishIdSelector);\n\n        case 3:\n          dishId = _context4.sent;\n          _context4.next = 6;\n          return select(sizesFormValuesSelector);\n\n        case 6:\n          items = _context4.sent;\n          _context4.next = 9;\n          return select(dishListFiltersSelector);\n\n        case 9:\n          filters = _context4.sent;\n          sizesPayload = {\n            category_id: filters.category_id,\n            items: items\n          };\n          payload = {\n            dishId: dishId,\n            sizesPayload: sizesPayload\n          };\n          _context4.next = 14;\n          return call(patchDishSizesSaga, {\n            payload: payload\n          });\n\n        case 14:\n          _context4.next = 16;\n          return put(showToast({\n            text: 'The dish sizes saved successful',\n            type: 'success'\n          }));\n\n        case 16:\n          _context4.next = 18;\n          return put(reset(SIZES_FORM));\n\n        case 18:\n          _context4.next = 25;\n          break;\n\n        case 20:\n          _context4.prev = 20;\n          _context4.t0 = _context4[\"catch\"](0);\n          console.error(_context4.t0);\n          _context4.next = 25;\n          return put(showToast({\n            text: 'Some error occured while saving dish sizes',\n            type: 'error'\n          }));\n\n        case 25:\n        case \"end\":\n          return _context4.stop();\n      }\n    }\n  }, _marked4, this, [[0, 20]]);\n}\n\nfunction resetDishModalFormsSaga() {\n  return _regeneratorRuntime.wrap(function resetDishModalFormsSaga$(_context5) {\n    while (1) {\n      switch (_context5.prev = _context5.next) {\n        case 0:\n          _context5.next = 2;\n          return all([put(reset(DISH_INFO_FORM)), put(reset(SIZES_FORM)), put(reset(EXTRAS_FORM)), put(setDishModal({\n            activeStep: 0\n          }))]);\n\n        case 2:\n        case \"end\":\n          return _context5.stop();\n      }\n    }\n  }, _marked5, this);\n}\n\nfunction destroyDishModalFormsSaga() {\n  return _regeneratorRuntime.wrap(function destroyDishModalFormsSaga$(_context6) {\n    while (1) {\n      switch (_context6.prev = _context6.next) {\n        case 0:\n          _context6.next = 2;\n          return put(destroy(DISH_INFO_FORM, SIZES_FORM, EXTRAS_FORM));\n\n        case 2:\n        case \"end\":\n          return _context6.stop();\n      }\n    }\n  }, _marked6, this);\n}\n\nexport function dishModalSaga() {\n  return _regeneratorRuntime.wrap(function dishModalSaga$(_context7) {\n    while (1) {\n      switch (_context7.prev = _context7.next) {\n        case 0:\n          _context7.next = 2;\n          return all([takeLatest(DISH_MODAL__RESET_FORMS, resetDishModalFormsSaga), takeLatest(DISH_MODAL__FULLY_CLEAR, destroyDishModalFormsSaga), takeLatest(DISH_MODAL__CREATE, createDishFromModalSaga), takeLatest(DISH_MODAL__UPDATE_INFO, updateDishFromModalSaga), takeLatest(DISH_MODAL__PATCH_EXTRAS, patchDishExtrasFromModalSaga), takeLatest(DISH_MODAL__PATCH_SIZES, patchDishSizesFromModalSaga)]);\n\n        case 2:\n        case \"end\":\n          return _context7.stop();\n      }\n    }\n  }, _marked7, this);\n}\n;\n\n(function () {\n  var reactHotLoader = (typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal : require('react-hot-loader')).default;\n\n  if (!reactHotLoader) {\n    return;\n  }\n\n  reactHotLoader.register(createDishFromModalSaga, \"createDishFromModalSaga\", \"/home/vladimir/workspace/bestonlinemenus.loc/frontend/src/modules/modals/dish/dish-modal.sagas.js\");\n  reactHotLoader.register(updateDishFromModalSaga, \"updateDishFromModalSaga\", \"/home/vladimir/workspace/bestonlinemenus.loc/frontend/src/modules/modals/dish/dish-modal.sagas.js\");\n  reactHotLoader.register(patchDishExtrasFromModalSaga, \"patchDishExtrasFromModalSaga\", \"/home/vladimir/workspace/bestonlinemenus.loc/frontend/src/modules/modals/dish/dish-modal.sagas.js\");\n  reactHotLoader.register(patchDishSizesFromModalSaga, \"patchDishSizesFromModalSaga\", \"/home/vladimir/workspace/bestonlinemenus.loc/frontend/src/modules/modals/dish/dish-modal.sagas.js\");\n  reactHotLoader.register(resetDishModalFormsSaga, \"resetDishModalFormsSaga\", \"/home/vladimir/workspace/bestonlinemenus.loc/frontend/src/modules/modals/dish/dish-modal.sagas.js\");\n  reactHotLoader.register(destroyDishModalFormsSaga, \"destroyDishModalFormsSaga\", \"/home/vladimir/workspace/bestonlinemenus.loc/frontend/src/modules/modals/dish/dish-modal.sagas.js\");\n  reactHotLoader.register(dishModalSaga, \"dishModalSaga\", \"/home/vladimir/workspace/bestonlinemenus.loc/frontend/src/modules/modals/dish/dish-modal.sagas.js\");\n})();\n\n;\n\n(function () {\n  var leaveModule = (typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal : require('react-hot-loader')).leaveModule;\n  leaveModule && leaveModule(module);\n})();","map":{"version":3,"sources":["/home/vladimir/workspace/bestonlinemenus.loc/frontend/src/modules/modals/dish/dish-modal.sagas.js"],"names":["createDishFromModalSaga","updateDishFromModalSaga","patchDishExtrasFromModalSaga","patchDishSizesFromModalSaga","resetDishModalFormsSaga","destroyDishModalFormsSaga","dishModalSaga","takeLatest","all","put","select","call","reset","destroy","DISH_MODAL__CREATE","DISH_MODAL__UPDATE_INFO","DISH_MODAL__RESET_FORMS","DISH_MODAL__PATCH_EXTRAS","DISH_MODAL__PATCH_SIZES","DISH_MODAL__FULLY_CLEAR","SIZES_FORM","EXTRAS_FORM","DISH_INFO_FORM","updateDishSaga","patchDishExtrasSaga","patchDishSizesSaga","createDishSaga","dishListFiltersSelector","dishInfoFormValuesSelector","extrasFormValuesSelector","sizesFormValuesSelector","setDishModal","showToast","managedDishIdSelector","body","filters","category_id","payload","dish","dishId","id","text","type","console","error","extrasPayload","items","sizesPayload","activeStep"],"mappings":"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","sourcesContent":["import { takeLatest, all, put, select, call } from 'redux-saga/effects';\nimport { reset, destroy } from 'redux-form';\nimport {\n  DISH_MODAL__CREATE,\n  DISH_MODAL__UPDATE_INFO,\n  DISH_MODAL__RESET_FORMS,\n  DISH_MODAL__PATCH_EXTRAS,\n  DISH_MODAL__PATCH_SIZES,\n  DISH_MODAL__FULLY_CLEAR,\n} from './dish-modal.types';\n\nimport {\n  SIZES_FORM,\n  EXTRAS_FORM,\n  DISH_INFO_FORM,\n} from '../../../components/forms/constants/form.names';\n\nimport {\n  updateDishSaga,\n  patchDishExtrasSaga,\n  patchDishSizesSaga,\n  createDishSaga,\n  dishListFiltersSelector,\n} from '../../dishes';\n\nimport {\n  dishInfoFormValuesSelector,\n  extrasFormValuesSelector,\n  sizesFormValuesSelector,\n} from '../../../components/forms/selectors';\n\nimport { setDishModal } from './dish-modal.actions';\nimport { showToast } from '../../../scenes/Toasts/modules';\nimport { managedDishIdSelector } from './dish-modal.selectors';\n\nfunction* createDishFromModalSaga() {\n  try {\n    const body = yield select(dishInfoFormValuesSelector);\n    const filters = yield select(dishListFiltersSelector);\n\n    body.category_id = filters.category_id;\n\n    const dish = yield call(createDishSaga, { payload: body });\n\n    yield put(setDishModal({ dishId: dish.id }));\n    yield put(\n      showToast({ text: 'The dish created successful', type: 'success' }),\n    );\n    yield put(reset(DISH_INFO_FORM));\n  } catch (error) {\n    console.error(error);\n    yield put(\n      showToast({\n        text: 'Some error occured while dish creating',\n        type: 'error',\n      }),\n    );\n  }\n}\n\nfunction* updateDishFromModalSaga() {\n  try {\n    const payload = yield select(dishInfoFormValuesSelector);\n    const id = yield select(managedDishIdSelector);\n    const filters = yield select(dishListFiltersSelector);\n\n    payload.category_id = filters.category_id;\n    payload.id = id;\n\n    yield call(updateDishSaga, { payload });\n\n    yield put(\n      showToast({ text: 'The dish updated successful', type: 'success' }),\n    );\n  } catch (error) {\n    console.error(error);\n    yield put(\n      showToast({\n        text: 'Some error occured while dish updating',\n        type: 'error',\n      }),\n    );\n  }\n}\n\nfunction* patchDishExtrasFromModalSaga() {\n  try {\n    const dishId = yield select(managedDishIdSelector);\n    const extrasPayload = yield select(extrasFormValuesSelector);\n\n    const payload = { dishId, extrasPayload };\n\n    yield call(patchDishExtrasSaga, { payload });\n    yield put(\n      showToast({ text: 'The dish extras saved successful', type: 'success' }),\n    );\n    yield put(reset(EXTRAS_FORM));\n  } catch (e) {\n    console.error(e);\n    yield put(\n      showToast({\n        text: 'Some error occured while saving dish extras',\n        type: 'error',\n      }),\n    );\n  }\n}\n\nfunction* patchDishSizesFromModalSaga() {\n  try {\n    const dishId = yield select(managedDishIdSelector);\n    const items = yield select(sizesFormValuesSelector);\n    const filters = yield select(dishListFiltersSelector);\n\n    const sizesPayload = {\n      category_id: filters.category_id,\n      items,\n    };\n\n    const payload = { dishId, sizesPayload };\n\n    yield call(patchDishSizesSaga, { payload });\n    yield put(\n      showToast({ text: 'The dish sizes saved successful', type: 'success' }),\n    );\n    yield put(reset(SIZES_FORM));\n  } catch (e) {\n    console.error(e);\n    yield put(\n      showToast({\n        text: 'Some error occured while saving dish sizes',\n        type: 'error',\n      }),\n    );\n  }\n}\n\nfunction* resetDishModalFormsSaga() {\n  yield all([\n    put(reset(DISH_INFO_FORM)),\n    put(reset(SIZES_FORM)),\n    put(reset(EXTRAS_FORM)),\n    put(setDishModal({ activeStep: 0 })),\n  ]);\n}\n\nfunction* destroyDishModalFormsSaga() {\n  yield put(destroy(DISH_INFO_FORM, SIZES_FORM, EXTRAS_FORM));\n}\n\nexport function* dishModalSaga() {\n  yield all([\n    takeLatest(DISH_MODAL__RESET_FORMS, resetDishModalFormsSaga),\n    takeLatest(DISH_MODAL__FULLY_CLEAR, destroyDishModalFormsSaga),\n    takeLatest(DISH_MODAL__CREATE, createDishFromModalSaga),\n    takeLatest(DISH_MODAL__UPDATE_INFO, updateDishFromModalSaga),\n    takeLatest(DISH_MODAL__PATCH_EXTRAS, patchDishExtrasFromModalSaga),\n    takeLatest(DISH_MODAL__PATCH_SIZES, patchDishSizesFromModalSaga),\n  ]);\n}\n"]},"metadata":{},"sourceType":"module"}