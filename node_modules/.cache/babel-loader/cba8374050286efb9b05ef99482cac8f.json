{"ast":null,"code":"import _objectSpread from \"/home/vladimir/workspace/bestonlinemenus.loc/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\n\n(function () {\n  var enterModule = (typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal : require('react-hot-loader')).enterModule;\n  enterModule && enterModule(module);\n})();\n\n/* eslint-disable no-use-before-define */\nexport var basePriceAndSelectedSizeDecorator = function basePriceAndSelectedSizeDecorator(dish) {\n  if (dish.selectedSize && typeof dish.selectedSize !== 'object') {\n    dish.selectedSize = getDishSelectedSize(dish);\n  }\n\n  dish.price = getBaseDishOrderItemPrice(dish, dish.selectedSize);\n  return dish;\n};\nexport var dishOrderForEditindDecorator = function dishOrderForEditindDecorator() {\n  var dish = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  basePriceAndSelectedSizeDecorator(dish);\n  dish.totalPrice = dish.price + getTotalSelectedExtrasPrice(dish.extras);\n  dish.totalPrice += getTotalSelectedExtrasPriceFromLists(dish.extra_lists);\n  dish.totalPrice *= dish.amount || 1;\n\n  if (!dish.amount) {\n    dish.amount = 1;\n  }\n\n  return dish;\n};\nexport var getSelectedExtrasFromDish = function getSelectedExtrasFromDish(dish) {\n  var extrasFromLists = getExtrasFromLists(dish.extra_lists);\n  var singleExtras = (dish.extras || []).filter(isExtraSelectedFilter);\n  return extrasFromLists.concat(singleExtras);\n};\nexport var dishOrderWithSelectedExtrasDecorator = function dishOrderWithSelectedExtrasDecorator(oldDish) {\n  var dish = basePriceAndSelectedSizeDecorator(_objectSpread({}, oldDish));\n  var selectedExtras = getSelectedExtrasFromDish(dish);\n  dish.totalPrice = dish.price + getExtrasPrice(selectedExtras);\n  dish.totalPrice *= dish.amount || 1;\n  dish.selectedExtras = selectedExtras;\n  return dish;\n};\nexport var getTotalSelectedExtrasPrice = function getTotalSelectedExtrasPrice() {\n  var extras = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n  return extras.reduce(function (sum, _ref) {\n    var _ref$amount = _ref.amount,\n        amount = _ref$amount === void 0 ? 1 : _ref$amount,\n        price = _ref.price,\n        selected = _ref.selected;\n    return selected ? sum + price * amount : sum;\n  }, 0);\n};\nexport var isExtraSelectedFilter = function isExtraSelectedFilter(_ref2) {\n  var selected = _ref2.selected;\n  return !!selected;\n};\nexport var getTotalSelectedExtrasPriceFromLists = function getTotalSelectedExtrasPriceFromLists() {\n  var extrasLists = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n  return extrasLists.reduce(function (sum, _ref3) {\n    var allow_multiselection = _ref3.allow_multiselection,\n        items = _ref3.items,\n        selectedExtra = _ref3.selectedExtra;\n\n    if (!allow_multiselection && selectedExtra) {\n      var _items$find = items.find(function (_ref4) {\n        var id = _ref4.id;\n        return +id === +selectedExtra;\n      }),\n          _items$find$amount = _items$find.amount,\n          amount = _items$find$amount === void 0 ? 1 : _items$find$amount,\n          price = _items$find.price;\n\n      sum += +price * amount;\n    } else {\n      sum += getTotalSelectedExtrasPrice(items);\n    }\n\n    return sum;\n  }, 0);\n};\nexport var getBaseDishOrderItemPrice = function getBaseDishOrderItemPrice(item, selectedSize) {\n  return selectedSize && selectedSize.price ? +selectedSize.price : item.price;\n};\n\nfunction getExtrasFromLists() {\n  var lists = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n  var extras = [];\n  lists.forEach(function (list) {\n    var allow_multiselection = list.allow_multiselection,\n        items = list.items,\n        selectedExtra = list.selectedExtra;\n\n    if (!allow_multiselection && selectedExtra) {\n      var extra = list.items.find(function (_ref5) {\n        var id = _ref5.id;\n        return +id === +selectedExtra;\n      });\n\n      if (!extra.amount) {\n        extra.amount = 1;\n      }\n\n      extras.push(extra);\n    } else {\n      extras = extras.concat(items.filter(isExtraSelectedFilter));\n    }\n  }, []);\n  return extras;\n}\n\nfunction getDishSelectedSize(_ref6) {\n  var selectedSize = _ref6.selectedSize,\n      _ref6$sizes = _ref6.sizes,\n      sizes = _ref6$sizes === void 0 ? [] : _ref6$sizes;\n\n  if (!selectedSize || !sizes.length) {\n    return null;\n  }\n\n  return sizes.find(function (_ref7) {\n    var id = _ref7.id;\n    return +id === +selectedSize;\n  });\n}\n\nexport function getExtrasPrice() {\n  var extras = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n  return extras.reduce( // eslint-disable-next-line no-return-assign\n  function (sum, _ref8) {\n    var price = _ref8.price,\n        _ref8$amount = _ref8.amount,\n        amount = _ref8$amount === void 0 ? 1 : _ref8$amount;\n    return sum += price * amount;\n  }, 0);\n}\nexport var getUnicOrderItemDescriptor = function getUnicOrderItemDescriptor() {\n  var dish = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var id = dish.id,\n      selectedSize = dish.selectedSize;\n  var sizeId;\n  var selectedExtras = getSelectedExtrasFromDish(dish);\n  var dishDescriptor = \"dishId#\".concat(id);\n\n  if (selectedSize) {\n    sizeId = typeof selectedSize === 'object' ? selectedSize.id : selectedSize;\n    dishDescriptor += \"#sizeId\".concat(sizeId, \"#\");\n  }\n\n  var extrasDescriptor = generateSelectedExtraDescriptor(selectedExtras);\n  dishDescriptor += extrasDescriptor;\n  return dishDescriptor;\n};\nexport var generateSelectedExtraDescriptor = function generateSelectedExtraDescriptor() {\n  var extras = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n  return extras.reduce(function (descriptor, _ref9) {\n    var id = _ref9.id,\n        amount = _ref9.amount;\n    return \"\".concat(descriptor).concat(id, \":\").concat(amount);\n  }, 'extras#');\n};\nexport var prepeareOrderFormPayment = function prepeareOrderFormPayment(orderItems) {\n  var mergedItemsByDescriptors = orderItems.reduce(function (itemsByDescriptors, item) {\n    var descriptor = getUnicOrderItemDescriptor(item);\n\n    if (itemsByDescriptors[descriptor]) {\n      itemsByDescriptors[descriptor].amount += item.amount;\n    } else {\n      itemsByDescriptors[descriptor] = item;\n    }\n\n    return itemsByDescriptors;\n  }, {});\n  return Object.values(mergedItemsByDescriptors);\n};\nexport var generateCkeckoutStorageKeyByRestaurantId = function generateCkeckoutStorageKeyByRestaurantId(id) {\n  return \"CHECKOUT_FOR_RESTAURANT_WITH_ID_\".concat(id);\n};\n;\n\n(function () {\n  var reactHotLoader = (typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal : require('react-hot-loader')).default;\n\n  if (!reactHotLoader) {\n    return;\n  }\n\n  reactHotLoader.register(basePriceAndSelectedSizeDecorator, \"basePriceAndSelectedSizeDecorator\", \"/home/vladimir/workspace/bestonlinemenus.loc/frontend/src/modules/checkout/checkout.helpers.js\");\n  reactHotLoader.register(dishOrderForEditindDecorator, \"dishOrderForEditindDecorator\", \"/home/vladimir/workspace/bestonlinemenus.loc/frontend/src/modules/checkout/checkout.helpers.js\");\n  reactHotLoader.register(getSelectedExtrasFromDish, \"getSelectedExtrasFromDish\", \"/home/vladimir/workspace/bestonlinemenus.loc/frontend/src/modules/checkout/checkout.helpers.js\");\n  reactHotLoader.register(dishOrderWithSelectedExtrasDecorator, \"dishOrderWithSelectedExtrasDecorator\", \"/home/vladimir/workspace/bestonlinemenus.loc/frontend/src/modules/checkout/checkout.helpers.js\");\n  reactHotLoader.register(getTotalSelectedExtrasPrice, \"getTotalSelectedExtrasPrice\", \"/home/vladimir/workspace/bestonlinemenus.loc/frontend/src/modules/checkout/checkout.helpers.js\");\n  reactHotLoader.register(isExtraSelectedFilter, \"isExtraSelectedFilter\", \"/home/vladimir/workspace/bestonlinemenus.loc/frontend/src/modules/checkout/checkout.helpers.js\");\n  reactHotLoader.register(getTotalSelectedExtrasPriceFromLists, \"getTotalSelectedExtrasPriceFromLists\", \"/home/vladimir/workspace/bestonlinemenus.loc/frontend/src/modules/checkout/checkout.helpers.js\");\n  reactHotLoader.register(getBaseDishOrderItemPrice, \"getBaseDishOrderItemPrice\", \"/home/vladimir/workspace/bestonlinemenus.loc/frontend/src/modules/checkout/checkout.helpers.js\");\n  reactHotLoader.register(getExtrasFromLists, \"getExtrasFromLists\", \"/home/vladimir/workspace/bestonlinemenus.loc/frontend/src/modules/checkout/checkout.helpers.js\");\n  reactHotLoader.register(getDishSelectedSize, \"getDishSelectedSize\", \"/home/vladimir/workspace/bestonlinemenus.loc/frontend/src/modules/checkout/checkout.helpers.js\");\n  reactHotLoader.register(getExtrasPrice, \"getExtrasPrice\", \"/home/vladimir/workspace/bestonlinemenus.loc/frontend/src/modules/checkout/checkout.helpers.js\");\n  reactHotLoader.register(getUnicOrderItemDescriptor, \"getUnicOrderItemDescriptor\", \"/home/vladimir/workspace/bestonlinemenus.loc/frontend/src/modules/checkout/checkout.helpers.js\");\n  reactHotLoader.register(generateSelectedExtraDescriptor, \"generateSelectedExtraDescriptor\", \"/home/vladimir/workspace/bestonlinemenus.loc/frontend/src/modules/checkout/checkout.helpers.js\");\n  reactHotLoader.register(prepeareOrderFormPayment, \"prepeareOrderFormPayment\", \"/home/vladimir/workspace/bestonlinemenus.loc/frontend/src/modules/checkout/checkout.helpers.js\");\n  reactHotLoader.register(generateCkeckoutStorageKeyByRestaurantId, \"generateCkeckoutStorageKeyByRestaurantId\", \"/home/vladimir/workspace/bestonlinemenus.loc/frontend/src/modules/checkout/checkout.helpers.js\");\n})();\n\n;\n\n(function () {\n  var leaveModule = (typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal : require('react-hot-loader')).leaveModule;\n  leaveModule && leaveModule(module);\n})();","map":{"version":3,"sources":["/home/vladimir/workspace/bestonlinemenus.loc/frontend/src/modules/checkout/checkout.helpers.js"],"names":["basePriceAndSelectedSizeDecorator","dish","selectedSize","getDishSelectedSize","price","getBaseDishOrderItemPrice","dishOrderForEditindDecorator","totalPrice","getTotalSelectedExtrasPrice","extras","getTotalSelectedExtrasPriceFromLists","extra_lists","amount","getSelectedExtrasFromDish","extrasFromLists","getExtrasFromLists","singleExtras","filter","isExtraSelectedFilter","concat","dishOrderWithSelectedExtrasDecorator","oldDish","selectedExtras","getExtrasPrice","reduce","sum","selected","extrasLists","allow_multiselection","items","selectedExtra","find","id","item","lists","forEach","list","extra","push","sizes","length","getUnicOrderItemDescriptor","sizeId","dishDescriptor","extrasDescriptor","generateSelectedExtraDescriptor","descriptor","prepeareOrderFormPayment","orderItems","mergedItemsByDescriptors","itemsByDescriptors","Object","values","generateCkeckoutStorageKeyByRestaurantId"],"mappings":"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","sourcesContent":["/* eslint-disable no-use-before-define */\nexport const basePriceAndSelectedSizeDecorator = dish => {\n  if (dish.selectedSize && typeof dish.selectedSize !== 'object') {\n    dish.selectedSize = getDishSelectedSize(dish);\n  }\n\n  dish.price = getBaseDishOrderItemPrice(dish, dish.selectedSize);\n\n  return dish;\n};\n\nexport const dishOrderForEditindDecorator = (dish = {}) => {\n  basePriceAndSelectedSizeDecorator(dish);\n\n  dish.totalPrice = dish.price + getTotalSelectedExtrasPrice(dish.extras);\n  dish.totalPrice += getTotalSelectedExtrasPriceFromLists(dish.extra_lists);\n  dish.totalPrice *= dish.amount || 1;\n\n  if (!dish.amount) {\n    dish.amount = 1;\n  }\n\n  return dish;\n};\n\nexport const getSelectedExtrasFromDish = dish => {\n  const extrasFromLists = getExtrasFromLists(dish.extra_lists);\n  const singleExtras = (dish.extras || []).filter(isExtraSelectedFilter);\n\n  return extrasFromLists.concat(singleExtras);\n};\n\nexport const dishOrderWithSelectedExtrasDecorator = oldDish => {\n  const dish = basePriceAndSelectedSizeDecorator({ ...oldDish });\n\n  const selectedExtras = getSelectedExtrasFromDish(dish);\n\n  dish.totalPrice = dish.price + getExtrasPrice(selectedExtras);\n  dish.totalPrice *= dish.amount || 1;\n  dish.selectedExtras = selectedExtras;\n\n  return dish;\n};\n\nexport const getTotalSelectedExtrasPrice = (extras = []) =>\n  extras.reduce(\n    (sum, { amount = 1, price, selected }) =>\n      selected ? sum + price * amount : sum,\n    0,\n  );\n\nexport const isExtraSelectedFilter = ({ selected }) => !!selected;\n\nexport const getTotalSelectedExtrasPriceFromLists = (extrasLists = []) =>\n  extrasLists.reduce((sum, { allow_multiselection, items, selectedExtra }) => {\n    if (!allow_multiselection && selectedExtra) {\n      const { amount = 1, price } = items.find(\n        ({ id }) => +id === +selectedExtra,\n      );\n      sum += +price * amount;\n    } else {\n      sum += getTotalSelectedExtrasPrice(items);\n    }\n\n    return sum;\n  }, 0);\n\nexport const getBaseDishOrderItemPrice = (item, selectedSize) =>\n  selectedSize && selectedSize.price ? +selectedSize.price : item.price;\n\nfunction getExtrasFromLists(lists = []) {\n  let extras = [];\n\n  lists.forEach(list => {\n    const { allow_multiselection, items, selectedExtra } = list;\n\n    if (!allow_multiselection && selectedExtra) {\n      const extra = list.items.find(({ id }) => +id === +selectedExtra);\n\n      if (!extra.amount) {\n        extra.amount = 1;\n      }\n\n      extras.push(extra);\n    } else {\n      extras = extras.concat(items.filter(isExtraSelectedFilter));\n    }\n  }, []);\n\n  return extras;\n}\n\nfunction getDishSelectedSize({ selectedSize, sizes = [] }) {\n  if (!selectedSize || !sizes.length) {\n    return null;\n  }\n\n  return sizes.find(({ id }) => +id === +selectedSize);\n}\n\nexport function getExtrasPrice(extras = []) {\n  return extras.reduce(\n    // eslint-disable-next-line no-return-assign\n    (sum, { price, amount = 1 }) => (sum += price * amount),\n    0,\n  );\n}\n\nexport const getUnicOrderItemDescriptor = (dish = {}) => {\n  const { id, selectedSize } = dish;\n  let sizeId;\n\n  const selectedExtras = getSelectedExtrasFromDish(dish);\n  let dishDescriptor = `dishId#${id}`;\n\n  if (selectedSize) {\n    sizeId = typeof selectedSize === 'object' ? selectedSize.id : selectedSize;\n\n    dishDescriptor += `#sizeId${sizeId}#`;\n  }\n\n  const extrasDescriptor = generateSelectedExtraDescriptor(selectedExtras);\n\n  dishDescriptor += extrasDescriptor;\n\n  return dishDescriptor;\n};\n\nexport const generateSelectedExtraDescriptor = (extras = []) =>\n  extras.reduce(\n    (descriptor, { id, amount }) => `${descriptor}${id}:${amount}`,\n    'extras#',\n  );\n\nexport const prepeareOrderFormPayment = orderItems => {\n  const mergedItemsByDescriptors = orderItems.reduce(\n    (itemsByDescriptors, item) => {\n      const descriptor = getUnicOrderItemDescriptor(item);\n\n      if (itemsByDescriptors[descriptor]) {\n        itemsByDescriptors[descriptor].amount += item.amount;\n      } else {\n        itemsByDescriptors[descriptor] = item;\n      }\n\n      return itemsByDescriptors;\n    },\n    {},\n  );\n\n  return Object.values(mergedItemsByDescriptors);\n};\n\nexport const generateCkeckoutStorageKeyByRestaurantId = id =>\n  `CHECKOUT_FOR_RESTAURANT_WITH_ID_${id}`;\n"]},"metadata":{},"sourceType":"module"}